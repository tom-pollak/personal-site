<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Tom Pollak</title>
    <link rel="stylesheet" href="/assets/css/main.css" />
  </head>
  <body>
    
    <!-- centers header and posts  -->
    <div class="sm:mx-16 mx-4 mb-8 max-w-3xl">
      
<div class="mt-8 pb-4">
  <h1 class="text-4xl text-gray-900 font-bold leading-tight">
    <a href="/">Tom Pollak</a>
  </h1>
  
</div>

 <div class="">
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$']  ],
        processEscapes: true
      }
    });
  </script>
  <script
    type="text/javascript"
    src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"
  ></script>
  <hr />
  <div class="pt-4 grid justify-items-center">
    <h1 class="text-2xl text-gray-800 pb-0.5">Calculating Placing Probabilities on Win Odds</h1>
    <p class="text-gray-500 text-sm pb-1">
      10th Feb 2022
    </p>
    <p class="text-gray-600 pb-4 text-[17px] italic">Determining the probability of a horse placing 4th for extra places</p>
  </div>
  <article class="justify-self-start prose"><p>Using a group of horseâ€™s win probabilities to determine the probability of a horse placing in a single position. This can be useful for comparing the odds for the race in different markets, where there could be potential for +EV bets in undervalued markets. Although the strategy is complete, I have yet to backtest it in any real markets so far.</p>

<p>For any such horse in a race, the probability they will place in position $k$ is as follows:</p>

\[P(X=k) = P(X = k\ |\ X \neq (1..k-1)) \times P(X \neq (1..k-1))\]

<p>The algorithm to solve this recursively tries every combination of horse positions, the variable <code class="language-plaintext highlighter-rouge">neg_prob</code> to track the total probability left for all the horses in solution, and <code class="language-plaintext highlighter-rouge">cur_adj_factor</code> keeps track of the probability of the solution actually happening.</p>

<p>To calculate the final horse probability for a given position, you must sum together every solution in which the horse finishes in that position.</p>

<p>The algorithm has a time complexity of $P(h,n) = O\left(\frac{h!}{(h - n)!}\right)$ Where $h$ is the number of horses and $n$ is the number of places you want to calculate up to where $n \leq h$.</p>

<script src="https://gist.github.com/tom-pollak/818f2d1dd21575bc7924bc44feb1d50d.js"></script>

<p>Check out the whole project: <a href="https://github.com/tom-pollak/each-way-matcher">tom-pollak/each-way-matcher</a></p>
</article>
</div>

    </div>
</html>
